# Redis

UDTS 可以将原生 Redis 或使用代理的分布式版本（包括 UCloud Redis 分布式版、Codis、Twemproxy）作为数据源/目标 进行全量+增量任务的传输。
当前支持的版本为 3.0 至 6.0 各版本与 7.0 主备版。跨大版本迁移可能存在兼容性问题，建议通过中转库迁移。例如，从3.x/4.x迁移到7.x时，需要创建5.x/6.x版本的中转库，先从3.x/4.x迁移到5.x/6.x，再从5.x/6.x迁移到7.x。

## 功能限制
- 如果源是读写分离版，需要使用 rump 模式迁移，迁移只能做全量，不支持增量。7.0版本不支持 rump 模式

## 注意事项
- 对于源和目的集群节点数目不需要一致
- 当 Redis 源为公网端，且为集群模式的情况下，需要将目标端 VPC 下的子网 ID 绑定 NATGW
- 需要确保源库的 `repl-diskless-sync` 配置为 `NO`
- 如果源库为分布式版（包括 UCloud Redis 分布式版、Codis、Twemproxy），需要创建多个任务，每个任务的源库填写一个分布式节点的地址，类型选择主备版。
- 目标库为 UCloud Redis 分布式版时，目标库类型选择分布式版，地址为代理地址。
- 目标库为 UCloud Redis 分布式 Cluster 版本且提供了代理地址时，目标库类型选择分布式版，地址为代理地址。
- 目标库为 UCloud Redis 分布式 Cluster 版本且没有提供代理地址时，目标库类型选择集群版，地址为分片地址，多个地址之间用";"相连。
- 目标库为集群版时，只支持迁移db0。

## Redis填写表单

| 参数名           | 说明                                                                                                                        |
|------------------|---------------------------------------------------------------------------------------------------------------------------|
| 地址             | 数据库地址，只填写主(master)地址。集群模式下，多个地址用";"相连，例如：192.168.1.100:6379;192.168.1.120:6379;192.168.1.130:26379 |
| 密码             | Redis密码，非必填                                                                                                            |
| Redis类型        | 集群模式/主备模式/分布式版                                                                        |
| VPC ID           | VPC ID，redis 所属 vpc                                                                                                       |
| 所属子网         | VPC下所属子网， redis 所属子网                                                                                               |
| 是否开启Rump同步 | 当用户无 psync 权限时需要通过Rump同步。                                                                                      |

## 断点续传
满足以下条件将自动开启断点续传功能
- 任务已运行到增量阶段
- 源目类型一致，比如主备模式传输到主备模式，集群模式传输到集群模式
- 源目均为集群模式时，源目集群节点数一致
- 源库版本为 3.0 至 6.0
